)
png(filename = 'figures/02-ivi-full-v2.png',width = 2000,height=2000,res=300)
cent_network.vis(
graph = g,
cent.metric = ivi,
directed = FALSE,
plot.title = "Belief Network - Complete ESS R9 dataset",
weighted = TRUE,
legend.title = "IVI value",
layout = 'fr',
dist.power = 0.4,
node.size.min = 22,
node.size.max = 40,
node.color = 'C',
label.color = 'black',
label.cex = 0.13,
stroke.color = 'black',
stroke.size=2,
show.labels = TRUE,
)
dev.off()
### IVI BY COUNTRY
ivi_cntry <- ivi_group_discrete(data,netvars,'Country',countries)
write_csv(ivi_cntry,file='output/ivi-country.csv')
### plot this
library(ggplot2)
pdata <- cbind(countries[,1],ivi_cntry)
colnames(pdata)[1] = 'Country'
pdata %>% ggplot(aes(
x = reorder(Country, Politicians),
y = Politicians,
group = 1
))  +geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
coord_flip() +
xlab("") +
ylab("IVI of Trust in Politicians")
theme_bw()
pdata %>% ggplot(aes(
x = reorder(Country, Health),
y = Health,
group = 1
))  +geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
coord_flip() +
xlab("") +
ylab("IVI of Satifaction with healthcare")
theme_bw()
pdata %>% ggplot(aes(
x = reorder(Country, Economy),
y = Economy,
group = 1
))  +geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
coord_flip() +
xlab("") +
ylab("IVI of Satifaction with the Economy")
theme_bw()
pdata %>% ggplot(aes(
x = reorder(Country, Democracy),
y = Democracy,
group = 1
))  +geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
coord_flip() +
xlab("") +
ylab("IVI of Satifaction with the Democracy")
theme_bw()
### IVI BY ROW
row = as.data.frame(c(1,2,3))
ivi_row <- ivi_group_discrete(data,netvars,'ROW',row)
write_csv(ivi_row,file='output/ivi-row.csv')
### IVI BY CLASS
classes = as.data.frame(levels(data$Class5))
ivi_class <- ivi_group_discrete(data,netvars,'Class5',classes)
View(ivi_row)
View(ivi_class)
View(ivi_cntry)
data$ROW <- as.factor(data$ROW)
levels(data$ROW) <- c('LD','ED','EA')
nt1 <- networktree(nodevars=data[,netvars],
splitvars=data[,c("ROW")],
transform='glasso',
method='mob')
nt1
comparetree(nt1, id1 = 2, id2 = 5, highlights = 3, plot = TRUE,labels=netvars)
library(EGAnet)
library(tidyverse)
library(dplyr)
load('data-clean/data-clean.Rds')
netvars <-
c(
'PeopleAllow',
'PeopleInfluence',
'Parliament',
'Legal',
'Police',
'Politicians',
'Parties',
'Economy',
#'Government',
'Democracy',
'Education',
'Health',
'FairChance',
'CitInterest',
'Transparent'
)
netdata <- data %>% select(netvars)
uva1 <-
UVA(
netdata,
n = nrow(netdata),
model = 'glasso',
corr = 'cor_auto',
method = 'wTO',
reduce = TRUE,
reduce.method = 'remove',
adhoc = TRUE,
)
uva1 <-
UVA(
netdata,
n = nrow(netdata),
model = 'glasso',
corr = 'cor_auto',
method = 'wTO',
reduce = TRUE,
reduce.method = 'remove',
adhoc = TRUE,
)
netdata <- uva1$reduced$data
uva2 <-
UVA(
netdata,
n = nrow(netdata),
model = 'glasso',
corr = 'cor_auto',
method = 'wTO',
reduce = TRUE,
reduce.method = 'remove',
adhoc = TRUE,
)
uva2
netdata <- as.data.frame(uva2$reduced$data)
save(netdata,file='data-clean/data-reduced.Rds')
ega <-
EGA(
data[, netvars],
model = 'glasso',
algorithm = 'louvain',
plot.EGA = FALSE,
uni.method = 'expand'
)
ega <-
EGA(
data[, netvars],
model = 'glasso',
algorithm = 'louvain',
plot.EGA = FALSE,
#uni.method = 'expand'
)
plot(ega)
netdata <- as.data.frame(uva2$reduced$data)
netvars <- c(colnames(netdata))
netvars
ega <-
EGA(
data[, netvars],
model = 'glasso',
algorithm = 'louvain',
plot.EGA = FALSE,
#uni.method = 'expand'
)
plot(ega)
ega <-
EGA(
data[, netvars],
model = 'glasso',
algorithm = 'louvain',
plot.EGA = FALSE,
uni.method = 'expand'
)
plot(ega)
ega <-
EGA(
data[, netvars],
model = 'glasso',
algorithm = 'louvain',
plot.EGA = FALSE,
)
save(netdata,file='data-clean/data-reduced.Rds')
load('data-clean/data-reduced.Rds')
load('data-clean/data-clean.Rds')
netvars <- c(colnames(netdata))
data$ROW <- as.factor(data$ROW)
levels(data$ROW) <- c('LD','ED','EA')
nt1 <- networktree(nodevars=data[,netvars],
splitvars=data[,c("ROW")],
transform='glasso',
method='mob')
nt1
comparetree(nt1, id1 = 2, id2 = 5, highlights = 3, plot = TRUE,labels=netvars)
comparetree(nt1, id1 = 3, id2 = 5, highlights = 3, plot = TRUE,labels=netvars)
comparetree(nt1, id1 = 2, id2 = 5, highlights = 3, plot = TRUE,labels=netvars)
comparetree(nt1, id1 = 2, id2 = 5, highlights = 5, plot = TRUE,labels=netvars)
library(influential)
library(igraph)
library(tidyverse)
library(EGAnet)
load('data-clean/data-reduced.Rds')
load('data-clean/data-clean.Rds')
netvars <- c(colnames(netdata))
countries <- as.data.frame(read_csv('data-clean/external-data.csv'))['Country']
row <- as.data.frame(read_csv('data-clean/external-data.csv'))['Country']
ivi_group_discrete <- function(data,netvars,filtervar,filter)
{
labels=colnames(data)
resmat = matrix(0,nrow(filter),length(netvars))
for (i in 1:nrow(filter))
{
datai = data[which(data[filtervar]==filter[i,]),]
ega <-
EGA(datai[, netvars],
model = 'glasso',
algorithm = 'louvain',
plot.EGA = FALSE)
g <-  graph_from_adjacency_matrix(ega$network,
weighted = TRUE,
mode = "undirected")
g_v <- V(g)
ivi <- ivi(
graph = g,
vertices = g_v,
directed = FALSE,
scaled = TRUE,
mode='all',
weights=E(g)$weights,
d = 1
)
resmat[i,] = ivi
}
resmat = as.data.frame(resmat)
colnames(resmat)<-rownames(as.data.frame(ivi))
rownames(resmat) <- (filter[,1])
return(resmat)
}
### IVI ON A FULL SAMPLE
ega <-
EGA(data[, netvars],
model = 'glasso',
algorithm = 'louvain',
plot.EGA = FALSE)
g <-  graph_from_adjacency_matrix(ega$network,
weighted = TRUE,
mode = "undirected")
g_v <- V(g)
ivi <- ivi(
graph = g,
vertices = g_v,
directed = FALSE,
scaled = TRUE,
mode='all',
weights=E(g)$weights,
d =1
)
png(filename = 'figures/02-ivi-full-v2.png',width = 2000,height=2000,res=300)
cent_network.vis(
graph = g,
cent.metric = ivi,
directed = FALSE,
plot.title = "Belief Network - Complete ESS R9 dataset",
weighted = TRUE,
legend.title = "IVI value",
layout = 'fr',
dist.power = 0.4,
node.size.min = 22,
node.size.max = 40,
node.color = 'C',
label.color = 'black',
label.cex = 0.13,
stroke.color = 'black',
stroke.size=2,
show.labels = TRUE,
)
dev.off()
### IVI BY COUNTRY
ivi_cntry <- ivi_group_discrete(data,netvars,'Country',countries)
write_csv(ivi_cntry,file='output/ivi-country.csv')
### plot this
library(ggplot2)
pdata <- cbind(countries[,1],ivi_cntry)
colnames(pdata)[1] = 'Country'
pdata %>% ggplot(aes(
x = reorder(Country, Politicians),
y = Politicians,
group = 1
))  +geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
coord_flip() +
xlab("") +
ylab("IVI of Trust in Politicians")
theme_bw()
pdata %>% ggplot(aes(
x = reorder(Country, Health),
y = Health,
group = 1
))  +geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
coord_flip() +
xlab("") +
ylab("IVI of Satifaction with healthcare")
theme_bw()
pdata %>% ggplot(aes(
x = reorder(Country, Economy),
y = Economy,
group = 1
))  +geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
coord_flip() +
xlab("") +
ylab("IVI of Satifaction with the Economy")
theme_bw()
pdata %>% ggplot(aes(
x = reorder(Country, Democracy),
y = Democracy,
group = 1
))  +geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
coord_flip() +
xlab("") +
ylab("IVI of Satifaction with the Democracy")
theme_bw()
### IVI BY ROW
row = as.data.frame(c(1,2,3))
ivi_row <- ivi_group_discrete(data,netvars,'ROW',row)
write_csv(ivi_row,file='output/ivi-row.csv')
### IVI BY CLASS
classes = as.data.frame(levels(data$Class5))
ivi_class <- ivi_group_discrete(data,netvars,'Class5',classes)
View(ivi_class)
View(ivi_row)
View(ivi_cntry)
View(ivi_class)
png(filename = 'figures/02-ivi-full-v2.png',width = 2000,height=2000,res=300)
cent_network.vis(
graph = g,
cent.metric = ivi,
directed = FALSE,
plot.title = "Belief Network - Complete ESS R9 dataset",
weighted = TRUE,
legend.title = "IVI value",
layout = 'fr',
dist.power = 0.4,
node.size.min = 15,
node.size.max = 22,
node.color = 'C',
label.color = 'black',
label.cex = 0.13,
stroke.color = 'black',
stroke.size=2,
show.labels = TRUE,
)
dev.off()
View(data)
classes = as.data.frame(levels(data$Class8))
ivi_class <- ivi_group_discrete(data,netvars,'Class8',classes)
View(ivi_cntry)
View(ivi_class)
### IVI BY CLASS
classes = as.data.frame(levels(data$Class5))
ivi_class <- ivi_group_discrete(data,netvars,'Class5',classes)
factorsNumeric <-  function(d)
modifyList(d, lapply(d[, sapply(d, is.factor)], as.numeric))
load('data-clean/data-oesch.Rds')
voi <- c('psppsgva','psppipla','trstprl', 'trstplt',
'trstprt',
'trstlgl','trstplc','stfeco',
#'stfgov',
'stfdem','stfedu',
'stfhlth','frprtpl','gvintcz',
'poltran','gndr','agea',
'cntry','rlgblg','eduyrs','class8','class5')
data <- data_clean %>% select(voi)
data[c(
'psppsgva',
'psppipla',
'trstprl',
'trstlgl',
'trstplc',
'trstplt',
'trstprt',
'stfeco',
'stfgov',
'stfdem',
'stfedu',
'stfhlth',
'frprtpl',
'gvintcz',
'poltran'
)] <- factorsNumeric(data[c(
'psppsgva',
'psppipla',
'trstprl',
'trstlgl',
'trstplc',
'trstplt',
'trstprt',
'stfeco',
'stfgov',
'stfdem',
'stfedu',
'stfhlth',
'frprtpl',
'gvintcz',
'poltran'
)])
colnames(data) <-c('PeopleAllow','PeopleInfluence','Parliament',
'Legal','Police','Politicians','Parties','Economy',
'Government',
'Democracy','Education',
'Health','FairChance','CitInterest',
'Transparent','Gender','Age','Country','ReligionBelong','Education','Class8','Class5')
save(data,file='data-clean/data-clean.Rds')
factorsNumeric <-  function(d)
modifyList(d, lapply(d[, sapply(d, is.factor)], as.numeric))
load('data-clean/data-oesch.Rds')
voi <- c('psppsgva','psppipla','trstprl', 'trstplt',
'trstprt',
'trstlgl','trstplc','stfeco',
'stfgov',
'stfdem','stfedu',
'stfhlth','frprtpl','gvintcz',
'poltran','gndr','agea',
'cntry','rlgblg','eduyrs','class8','class5')
data <- data_clean %>% select(voi)
data[c(
'psppsgva',
'psppipla',
'trstprl',
'trstlgl',
'trstplc',
'trstplt',
'trstprt',
'stfeco',
'stfgov',
'stfdem',
'stfedu',
'stfhlth',
'frprtpl',
'gvintcz',
'poltran'
)] <- factorsNumeric(data[c(
'psppsgva',
'psppipla',
'trstprl',
'trstlgl',
'trstplc',
'trstplt',
'trstprt',
'stfeco',
'stfgov',
'stfdem',
'stfedu',
'stfhlth',
'frprtpl',
'gvintcz',
'poltran'
)])
colnames(data) <-c('PeopleAllow','PeopleInfluence','Parliament',
'Legal','Police','Politicians','Parties','Economy',
'Government',
'Democracy','Education',
'Health','FairChance','CitInterest',
'Transparent','Gender','Age','Country','ReligionBelong','Education','Class8','Class5')
save(data,file='data-clean/data-clean.Rds')
library(dplyr)
library(tidyverse)
load('data-clean/data-clean.Rds')
ext = read.csv('data-clean/external-data.csv')
n = nrow(data)
data<- data %>% add_column(Geff=NA,Rol=NA,Vaa=NA,Pstab=NA,ROW=NA)
for(i in 1:n)
{
c = data$Country[i]
j = which(ext$Country==c)
data$Geff[i] = ext$GEff[j]
data$Rol[i] = ext$RoL[j]
data$Vaa[i] = ext$VaA[j]
data$Pstab[i] = ext$Pstab[j]
data$ROW[i] = ext$ROW[j]
}
save(data,file='data-clean/data-clean.Rds')
ega <-
EGA(
data[, netvars],
model = 'glasso',
algorithm = 'louvain',
plot.EGA = FALSE
)
plot(ega)
nt4 <- networktree(nodevars=data[,netvars],
splitvars=data[,c("Government")],
transform='glasso',
method = 'mob')
nt4
comparetree(nt3, id1 = 2, id2 = 9, highlights = 3, plot = TRUE,labels=netvars)
nt5 <- networktree(nodevars=data[,netvars],
splitvars=data[,c("Government")],
transform='glasso',
method = 'mob')
nt5
comparetree(nt5, id1 = 2, id2 = 9, highlights = 3, plot = TRUE,labels=netvars)
comparetree(nt5, id1 = 2, id2 = 13, highlights = 3, plot = TRUE,labels=netvars)
comparetree(nt5, id1 = 3, id2 = 17, highlights = 3, plot = TRUE,labels=netvars)
nt5 <- networktree(nodevars=data[,netvars],
splitvars=data[,c("Government")],
transform='glasso',
method = 'ctree')
comparetree(nt5, id1 = 3, id2 = 17, highlights = 3, plot = TRUE,labels=netvars)
